import { NextResponse } from "next/server";
import { getItem } from "@utils/cookies";

export async function middleware(req) {
  const accessToken = getItem("token", { req });

  if (accessToken) {
    return NextResponse.rewrite(new URL(req.url));
  }

  return NextResponse.redirect(new URL("/login", req.url));
}

export const config = {
  matcher: [
    "/home/:path*",
    "/notifications/:path*",
    "/post/:path*",
    "/profile/:path*",
    "/search/:path*",
    "/settings/:path*",
    "/404",
  ],
};
